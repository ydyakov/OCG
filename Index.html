<!DOCTYPE html>
<html lang="bg">
<head>
    <meta charset="UTF-8" />
    <title>Космическа совалка - Three.js</title>
    <style>
        body {
            margin: 0;
            background-color: black;
            overflow: hidden;
        }
    </style>
    <script type="importmap">
        {
          "imports": {
            "three": "https://unpkg.com/three@0.166.1/build/three.module.js",
            "three/addons/": "https://unpkg.com/three@0.166.1/examples/jsm/"
          }
        }
    </script>
</head>
<body>
    <script type="module">
        import * as THREE from "three";

        const scene = new THREE.Scene();

        const camera = new THREE.PerspectiveCamera(
            60, window.innerWidth / window.innerHeight, 0.1, 1000
        );
        camera.position.z = 5;

        const ambientLight = new THREE.AmbientLight(0xffffff, 0.6);
        scene.add(ambientLight);

        const renderer = new THREE.WebGLRenderer({ antialias: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        document.body.appendChild(renderer.domElement);

    

     
     


        var buster = createBooster(0.3, 4);
        scene.add(buster);


        var buster1 = createBooster(0.3, 4);
        buster1.position.x += 2.5;
        scene.add(buster1);

        var tank = createTank(0.9, 3.5);
        tank.position.x += 1.3;
        tank.position.y += 1;
        scene.add(tank);

        //scene.add(tank);

        //var tank = createTank(0.5, 3);
        //tank.position.x += 4;
        //scene.add(tank);

        //var shuttle = createShuttle(0.5, 3);
        //shuttle.position.x -= 4;
        //scene.add(shuttle);

        // *********** functions ************************

        function createShuttle(r, h, radialSegments = 32, heightSegments = 16) {
            const shuttle = new THREE.Group();

            // Материали
            const mainMaterial = new THREE.MeshStandardMaterial({ color: 0xffffff });
            const noseMaterial = new THREE.MeshStandardMaterial({ color: 0xaaaaaa });
            const backMaterial = new THREE.MeshStandardMaterial({ color: 0x9999ff });
            const boosterMaterial1 = new THREE.MeshStandardMaterial({ color: 0xff6600 });
            const boosterMaterial2 = new THREE.MeshStandardMaterial({ color: 0xcc3300 });

            // --- Полуцилиндър (тяло)
            const cylinderGeom = new THREE.CylinderGeometry(r, r, h, radialSegments, heightSegments, false, 0, Math.PI);
            const body = new THREE.Mesh(cylinderGeom, mainMaterial);
            body.rotation.z = Math.PI / 2;
            shuttle.add(body);

            // --- Полуконус (нос)
            const noseGeom = new THREE.ConeGeometry(r, h * 0.6, radialSegments, heightSegments, false, 0, Math.PI);
            const nose = new THREE.Mesh(noseGeom, noseMaterial);
            nose.rotation.z = Math.PI / 2;
            nose.position.x = h / 2 + (h * 0.6) / 2;
            shuttle.add(nose);

            // --- Полусфера (задна част)
            const sphereGeom = new THREE.SphereGeometry(r, radialSegments, heightSegments, 0, Math.PI);
            const back = new THREE.Mesh(sphereGeom, backMaterial);
            back.rotation.z = Math.PI / 2;
            back.position.x = -h / 2 - r / 2;
            shuttle.add(back);

            // --- Три пресечени конуса (бустери)
            const boosterPositions = [
                new THREE.Vector3(-h / 2 - r * 0.5, 0, r * 1.2),
                new THREE.Vector3(-h / 2 - r * 0.5, 0, -r * 1.2),
                new THREE.Vector3(-h / 2 - r * 0.5, r * 1.2, 0)
            ];

            boosterPositions.forEach((pos, i) => {
                const geom = new THREE.CylinderGeometry(r * 0.4, r * 0.6, r * 1.2, radialSegments, heightSegments, false);
                const booster = new THREE.Mesh(geom, [boosterMaterial1, boosterMaterial2]);
                booster.rotation.z = Math.PI / 2;
                booster.position.copy(pos);
                shuttle.add(booster);
            });

            return shuttle;
        }

        function createTank(r, h) {
            const tank = new THREE.Group();

            // Материали
            const matBody = new THREE.MeshPhongMaterial({ color: 0xff8800 }); // оранжев NASA цвят

            // --- Основен цилиндър ---
            const cylGeom = new THREE.CylinderGeometry(r, r, h, 32);
            const body = new THREE.Mesh(cylGeom, matBody);
            tank.add(body);

            // --- Долна полусфера ---
            const sphereBottomGeom = new THREE.SphereGeometry(r, 32, 16, 0, Math.PI * 2, 0, Math.PI / 2);
            const sphereBottom = new THREE.Mesh(sphereBottomGeom, matBody);
            sphereBottom.position.y = -h / 2; // долу
            sphereBottom.rotation.x = Math.PI; // обърната наопаки, за да сочи надолу
            tank.add(sphereBottom);

            // --- Горна издължена полусфера ---
            const sphereTopGeom = new THREE.SphereGeometry(r, 32, 16, 0, Math.PI * 2, 0, Math.PI / 2);
            const sphereTop = new THREE.Mesh(sphereTopGeom, matBody);
            sphereTop.position.y = h / 2; // горе
            sphereTop.scale.y = 1.8; // издължаваме я по височина
            tank.add(sphereTop);

            return tank;
        }

        function createBooster(r, h) {
            const booster = new THREE.Group();

            // Материали
            const matMain = new THREE.MeshPhongMaterial({ color: 0xffffff });
            const matTip = new THREE.MeshPhongMaterial({ color: 0xdddddd });
            const matBottomOut = new THREE.MeshPhongMaterial({ color: 0xff6600, side: THREE.FrontSide });
            const matBottomIn = new THREE.MeshPhongMaterial({ color: 0x222222, side: THREE.BackSide });

            // --- Цилиндър (основно тяло)
            const cylGeom = new THREE.CylinderGeometry(r, r, h, 32); 
            const cyl = new THREE.Mesh(cylGeom, matMain);
            booster.add(cyl);

            // --- Горен конус (върхът)
            const coneGeom = new THREE.ConeGeometry(r , r * 1.2, 32);
            const cone = new THREE.Mesh(coneGeom, matTip);
            cone.position.y = h / 2 + (r * 1.2) / 2; // поставяме го върху цилиндъра
            booster.add(cone);

            // --- Долен пресечен конус (дюзата)
            const engingGeom = new THREE.CylinderGeometry(r * 1, r * 1.3, r, 32, 1, true);
            const engingGeomMeshOut = new THREE.Mesh(engingGeom, matBottomOut);
            const engingGeomMeshIn = new THREE.Mesh(engingGeom, matBottomIn);
            const enginGroup = new THREE.Group();
            enginGroup.add(engingGeomMeshOut);
            enginGroup.add(engingGeomMeshIn);
                   
            enginGroup.position.y = -h / 2 - (r) / 2; // под цилиндъра

            booster.add(enginGroup);

            return booster;
        }


        // *************************************
        import { OrbitControls } from "three/addons/controls/OrbitControls.js";

        // Добави това след като създадеш camera и renderer
        const controls = new OrbitControls(camera, renderer.domElement);
        controls.enableDamping = true; // по-плавно движение
        controls.dampingFactor = 0.05;

        animate();

        function animate() {
            requestAnimationFrame(animate);
            controls.update();
            renderer.render(scene, camera);
        }

        window.addEventListener("resize", () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        });
    </script>
</body>
</html>
